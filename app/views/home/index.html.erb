<h1>Search for Plants</h1>

<%= form_with url: home_index_path, method: :get, local: true do %>
  <%= label_tag :query, "Enter plant name:" %>
  <%= text_field_tag :query, params[:query] %>
  <%= submit_tag "Search" %>
<% end %>

<% if @plants.any? %>
  <h2>Search Results</h2>
  <div class="row">
    <% @plants.each do |plant_wrapper| %>
      <% plant = plant_wrapper["item"] %>
      <div class="col-md-4 d-flex align-items-stretch">
        <div class="card mb-4">
          <%= image_tag plant["Img"], class: "card-img-top fixed-img", alt: (plant["Common name"]&.join(", ") || "Plant Image") %>
          <div class="card-body d-flex flex-column">
            <% common_names = plant["Common name"] || [] %>
            <% common_names = [common_names] if common_names.is_a?(String) %>
            <h5 class="card-title"><%= common_names.join(", ") %></h5>
            <p class="card-text mb-4">
              <strong>Latin Name:</strong> <em><%= plant["Latin name"] || "Unknown Latin name" %></em>
            </p>
            <ul class="list-group list-group-flush flex-grow-1">
              <li class="list-group-item"><strong>Categories:</strong> <%= plant["Categories"] %></li>
              <li class="list-group-item"><strong>Availability:</strong> <%= plant["Avaibility"] %></li>
              <li class="list-group-item"><strong>Light Ideal:</strong> <%= plant["Light ideal"] %></li>
            </ul>
            <div class="mt-auto">
              <a href="<%= plant["Url"] %>" class="card-link" target="_blank">More Info</a>
            </div>
          </div>
        </div>
      </div>
    <% end %>
  </div>
<% end %>
