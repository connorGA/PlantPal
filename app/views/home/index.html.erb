<h1>My Plant Collection</h1>

<% if @plants && @plants.any? %>
  <div class="row">
    <% @plants.each do |plant| %>
      <div class="col-sm-6 col-md-4 col-lg-3 d-flex align-items-stretch">
        <div class="card mb-4 small-card card-hover position-relative" style="cursor: pointer;" onclick="location.href='<%= show_plant_path(plant) %>'">
          <%= image_tag plant.image_url, class: "card-img-top fixed-img", alt: plant.common_name %>
          <div class="card-body d-flex flex-column">
            <h5 class="card-title"><%= plant.common_name %></h5>
            <p class="card-text mb-4">
              <strong>Latin Name:</strong> <em><%= plant.latin_name %></em>
            </p>
            <ul class="list-group list-group-flush flex-grow-1">
              <li class="list-group-item"><strong>Categories:</strong> <%= plant.categories %></li>
              <li class="list-group-item"><strong>Watering:</strong> <%= plant.watering %></li>
              <li class="list-group-item"><strong>Light Ideal:</strong> <%= plant.light_ideal %></li>
            </ul>
            <div class="mt-auto d-flex justify-content-between">
              <a href="<%= plant.url %>" class="card-link" target="_blank">More Info</a>
              <%= button_to 'Remove', remove_from_collection_home_path(plant), method: :delete, class: 'btn btn-danger ml-auto' %>
            </div>
          </div>

          <!-- Timer display in the top right corner of the card -->
            <% if plant.timer_end_at.present? %>
              <% remaining_time = plant.timer_end_at - Time.current %>
              <% days = (remaining_time / 1.day).to_i %>
              <% hours = ((remaining_time % 1.day) / 1.hour).to_i %>
              <% minutes = ((remaining_time % 1.hour) / 1.minute).to_i %>

              <div class="timer-display position-absolute top-0 right-0 p-2 bg-white text-dark rounded">
                <%= "#{days}d #{hours}h #{minutes}m" %>
              </div>
            <% end %>
        </div>
      </div>
    <% end %>
  </div>
<% else %>
  <p>You have no plants in your collection.</p>
<% end %>
